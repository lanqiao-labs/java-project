# 网盘项目 API

**简介**:网盘项目 API

**Version**:1.0

## 文件接口

### 批量删除文件

- 接口描述：批量删除文件
- 数据格式：JSON
- 请求方式：GET
- 接口 URL ：`http://localhost:8080/file/batchdeletefile`

<details>
  <summary>请求示例</summary>

```json
{
  "files": "[{\"userFileId\":1}, {\"userFileId\":2]"
}
```

</details>

请求数据说明：

| 参数名称          | 参数说明 | 是否必须 | 数据类型 |
| ----------------- | -------- | -------- | -------- |
| files | 文件集合 | true     | String   |

响应数据说明：

| 参数名称 | 参数说明                   | 类型    |
| -------- | -------------------------- | ------- |
| code     | 返回码                     | int     |
| data     | 响应数据                   | String  |
| message  | 处理结果信息               | String  |
| success  | 是否成功标识（true/false） | boolean |

<details>
  <summary>响应示例</summary>

```json
{
	"code": 20000,
	"data": "",
	"message": "批量删除文件成功",
	"success": true
}
```

</details>

### 批量移动文件

- 接口描述：可以同时选择移动多个文件或者目录
- 数据格式：JSON
- 请求方式：POST
- 接口 URL ：`http://localhost:8080/file/batchdeletefile`

<details>
  <summary>请求示例</summary>

```json
{
  "filePath": "测试1",
  "files": "[{\"userFileId\":1}, {\"userFileId\":2]"
}
```

</details>

请求数据说明：

| 参数名称             | 参数说明 | 是否必须 | 数据类型 |
| -------------------- | -------- | -------- | -------- |
| filePath | 文件路径 | true     | String   |
| files    | 文件集合 | true     | String   |


响应数据说明：

| 参数名称 | 参数说明                   | 类型    |
| -------- | -------------------------- | ------- |
| code     | 返回码                     | int     |
| data     | 响应数据                   | String  |
| message  | 处理结果信息               | String  |
| success  | 是否成功标识（true/false） | boolean |

<details>
  <summary>响应示例</summary>

```json
{
	"code": 20000,
	"data": "",
	"message": "批量移动文件成功",
	"success": true
}
```

</details>

### 创建文件

- 接口描述：目录(文件夹)的创建
- 数据格式：JSON
- 请求方式：POST
- 接口 URL ：`http://localhost:8080/file/createfile`

<details>
  <summary>请求示例</summary>

```json
{
  "fileName": "测试创建",
  "filePath": "/"
}
```

</details>

请求数据说明：

| 参数名称             | 参数说明 | 是否必须 | 数据类型 |
| -------------------- | -------- | -------- | -------- |
| fileName | 文件名   | true     | String   |
| filePath | 文件路径 | true     | String   |

响应数据说明：

| 参数名称 | 参数说明                   | 类型    |
| -------- | -------------------------- | ------- |
| code     | 返回码                     | int     |
| data     | 响应数据                   | String  |
| message  | 处理结果信息               | String  |
| success  | 是否成功标识（true/false） | boolean |

<details>
  <summary>响应示例</summary>

```json
{
	"code": 20000,
	"data": "",
	"message": "创建文件成功",
	"success": true
}
```

</details>

### 删除文件

- 接口描述：可以删除文件或者目录
- 数据格式：JSON
- 请求方式：POST
- 接口 URL ：`http://localhost:8080/file/deletefile`

<details>
  <summary>请求示例</summary>

```json
{
  "fileName": "测试3",
  "filePath": "/",
  "isDir": 1,
  "userFileId": 3
}
```

</details>

请求数据说明：

| 参数名称               | 参数说明    | 是否必须 | 数据类型 |
| ---------------------- | ----------- | -------- | -------- |
| fileName   | 文件名      | true     | String   |
| filePath   | 文件路径    | true     | String   |
| isDir      | 是否是目录  | true     | int      |
| userFileId | 用户文件 id | true     | int      |

响应数据说明：

| 参数名称 | 参数说明                   | 类型    |
| -------- | -------------------------- | ------- |
| code     | 返回码                     | int     |
| data     | 响应数据                   | object  |
| message  | 处理结果信息               | String  |
| success  | 是否成功标识（true/false） | boolean |

<details>
  <summary>响应示例</summary>

```json
{
	"code": 20000,
	"data": "",
	"message": "删除文件成功",
	"success": true
}
```

</details>

### 获取文件列表

- 接口描述：用来做前台文件列表展示
- 数据格式：JSON
- 请求方式：GET
- 接口 URL ：`http://localhost:8080/file/getfilelist`

请求数据说明：

| 参数名称    | 参数说明 | 是否必须 | 数据类型 |
| ----------- | -------- | -------- | -------- |
| currentPage | 当前页   | true     | int      |
| filePath    | 文件路径 | true     | String   |
| pageCount   | 每页数量 | true     | int      |

响应数据说明：

| 参数名称                  | 参数说明                   | 类型           |
| ------------------------- | -------------------------- | -------------- |
| code                      | 返回码                     | int            |
| data                      | 响应数据                   | UserfileListVO |
| extendName    | 扩展名                     | String         |
| fileId        | 文件 id                    | int            |
| fileName      | 文件名                     | String         |
| filePath      | 文件路径                   | String         |
| fileSize      | 文件大小                   | int            |
| fileUrl       | 文件 url                   | String         |
| identifier    | md5                        | String         |
| isDir         | 是否是目录                 | int            |
| isOSS         | 是否是 oss 存储            | int            |
| pointCount    | 引用数量                   | int            |
| timeStampName | 时间戳名称                 | String         |
| uploadTime    | 上传时间                   | String         |
| userFileId    | 用户文件 id                | int            |
| userId        | 用户 id                    | int            |
| message                   | 处理结果信息               | String         |
| success                   | 是否成功标识（true/false） | boolean        |

<details>
  <summary>响应示例</summary>

```json
{
    "success": true, 
    "code": 20000, 
    "message": "成功", 
    "data": {
        "total": 4, 
        "list": [
            {
                "fileId": null, 
                "timeStampName": null, 
                "fileUrl": null, 
                "fileSize": null, 
                "isOSS": null, 
                "pointCount": null, 
                "identifier": null, 
                "userFileId": 1, 
                "userId": 1, 
                "fileName": "测试1", 
                "filePath": "/", 
                "extendName": null, 
                "isDir": 1, 
                "uploadTime": "2022-02-28 11:22:29"
            }, 
            {
                "fileId": null, 
                "timeStampName": null, 
                "fileUrl": null, 
                "fileSize": null, 
                "isOSS": null, 
                "pointCount": null, 
                "identifier": null, 
                "userFileId": 2, 
                "userId": 1, 
                "fileName": "测试2", 
                "filePath": "/", 
                "extendName": null, 
                "isDir": 1, 
                "uploadTime": "2022-02-28 11:22:38"
            }, 
            {
                "fileId": null, 
                "timeStampName": null, 
                "fileUrl": null, 
                "fileSize": null, 
                "isOSS": null, 
                "pointCount": null, 
                "identifier": null, 
                "userFileId": 4, 
                "userId": 1, 
                "fileName": "测试上传", 
                "filePath": "/", 
                "extendName": null, 
                "isDir": 1, 
                "uploadTime": "2022-02-28 11:37:45"
            }, 
            {
                "fileId": null, 
                "timeStampName": null, 
                "fileUrl": null, 
                "fileSize": null, 
                "isOSS": null, 
                "pointCount": null, 
                "identifier": null, 
                "userFileId": 8, 
                "userId": 1, 
                "fileName": "测试创建", 
                "filePath": "/", 
                "extendName": null, 
                "isDir": 1, 
                "uploadTime": "2022-02-28 11:43:10"
            }
        ]
    }
}
```

</details>

### 获取文件树

- 接口描述：文件移动的时候需要用到该接口，用来展示目录树
- 数据格式：JSON
- 请求方式：GET
- 接口 URL ：`http://localhost:8080/file/getfiletree`

请求数据说明： 

无

响应数据说明：

| 参数名称               | 参数说明                   | 类型       |
| ---------------------- | -------------------------- | ---------- |
| code                   | 返回码                     | int        |
| data                   | 响应数据                   | TreeNodeVO |
| attributes | 属性集合                   | object     |
| children   | 子节点列表                 | array      |
| depth      | 深度                       | int        |
| id         | 节点 id                    | int        |
| label      | 节点名                     | String     |
| state      | 是否被关闭                 | String     |
| message                | 处理结果信息               | String     |
| success                | 是否成功标识（true/false） | boolean    |

<details>
  <summary>响应示例</summary>

```json
{
    "success": true, 
    "code": null, 
    "message": null, 
    "data": {
        "id": null, 
        "label": "/", 
        "depth": null, 
        "state": "closed", 
        "attributes": { }, 
        "children": [
            {
                "id": null, 
                "label": "测试1", 
                "depth": null, 
                "state": "closed", 
                "attributes": {
                    "filePath": "/测试1/"
                }, 
                "children": [
                    {
                        "id": null, 
                        "label": "测试2", 
                        "depth": null, 
                        "state": "closed", 
                        "attributes": {
                            "filePath": "/测试1/测试2/"
                        }, 
                        "children": [ ]
                    }
                ]
            }, 
            {
                "id": null, 
                "label": "测试3", 
                "depth": null, 
                "state": "closed", 
                "attributes": {
                    "filePath": "/测试3/"
                }, 
                "children": [ ]
            }, 
            {
                "id": null, 
                "label": "测试上传", 
                "depth": null, 
                "state": "closed", 
                "attributes": {
                    "filePath": "/测试上传/"
                }, 
                "children": [ ]
            }, 
            {
                "id": null, 
                "label": "测试创建", 
                "depth": null, 
                "state": "closed", 
                "attributes": {
                    "filePath": "/测试创建/"
                }, 
                "children": [ ]
            }
        ]
    }
}
```

</details>

### 文件移动

- 接口描述：可以移动文件或者目录
- 数据格式：JSON
- 请求方式：POST
- 接口 URL ：`http://localhost:8080/file/movefile`

<details>
  <summary>请求示例</summary>

```json
{
  "extendName": null,
  "fileName": "测试2",
  "filePath": "/",
  "oldFilePath": "/测试1/"
}
```

</details>

请求数据说明：

| 参数名称                | 参数说明 | 是否必须 | 数据类型 |
| ----------------------- | -------- | -------- | -------- |
| extendName  | 扩展名   | true     | String   |
| fileName    | 文件名   | true     | String   |
| filePath    | 文件路径 | true     | String   |
| oldFilePath | 旧文件名 | true     | String   |

响应数据说明：

| 参数名称 | 参数说明                   | 类型    |
| -------- | -------------------------- | ------- |
| code     | 返回码                     | int     |
| data     | 响应数据                   | String  |
| message  | 处理结果信息               | String  |
| success  | 是否成功标识（true/false） | boolean |

<details>
  <summary>响应示例</summary>

```json
{
	"code": 20000,
	"data": "",
	"message": "文件移动成功",
	"success": true
}
```

</details>

### 文件重命名

- 接口描述：文件重命名
- 数据格式：JSON
- 请求方式：POST
- 接口 URL ：`http://localhost:8080/file/renamefile`

<details>
  <summary>请求示例</summary>

```json
{
  "fileName": "222333",
  "userFileId": 7
}
```

</details>

请求数据说明：

| 参数名称               | 参数说明    | 是否必须 | 数据类型 |
| ---------------------- | ----------- | -------- | -------- |
| fileName   | 文件名      | true     | String   |
| userFileId | 用户文件 id | true     | int      |

响应数据说明：

| 参数名称 | 参数说明                   | 类型    |
| -------- | -------------------------- | ------- |
| code     | 返回码                     | int     |
| data     | 响应数据                   | String  |
| message  | 处理结果信息               | String  |
| success  | 是否成功标识（true/false） | boolean |

<details>
  <summary>响应示例</summary>

```json
{
	"code": 20000,
	"data": "",
	"message": "文件重命名成功",
	"success": true
}
```

</details>

### 通过文件类型选择文件

- 接口描述：该接口可以实现文件格式分类查看
- 数据格式：JSON
- 请求方式：GET
- 接口 URL ：`http://localhost:8080/file/selectfilebyfiletype?fileType=1&currentPage=1&pageCount=20`

请求数据说明：

| 参数名称    | 参数说明 | 是否必须 | 数据类型 |
| ----------- | -------- | -------- | -------- |
| fileType    | 文件类型 | true     | int      |
| currentPage | 当前页   | true     | int      |
| pageCount   | 每页数量 | true     | int      |

响应数据说明：

| 参数名称 | 参数说明                   | 类型    |
| -------- | -------------------------- | ------- |
| code     | 返回码                     | int     |
| data     | 响应数据                   | array   |
| message  | 处理结果信息               | String  |
| success  | 是否成功标识（true/false） | boolean |

<details>
  <summary>响应示例</summary>

```json
{
    "success": true, 
    "code": 20000, 
    "message": "成功", 
    "data": {
        "total": 2, 
        "list": [
            {
                "fileId": 2, 
                "timeStampName": "4bcb0c0cae9725f377e92e28b281d31f", 
                "fileUrl": "/upload/20220228/4bcb0c0cae9725f377e92e28b281d31f.jpg", 
                "fileSize": 298888, 
                "isOSS": null, 
                "pointCount": 1, 
                "identifier": "4bcb0c0cae9725f377e92e28b281d31f", 
                "userFileId": 6, 
                "userId": 1, 
                "fileName": "11111111", 
                "filePath": "/测试1/", 
                "extendName": "jpg", 
                "isDir": 0, 
                "uploadTime": "2022-02-28 11:38:33"
            }, 
            {
                "fileId": 3, 
                "timeStampName": "aea05c6b808f0501d3aca7dca6ea77c7", 
                "fileUrl": "/upload/20220228/aea05c6b808f0501d3aca7dca6ea77c7.jpg", 
                "fileSize": 292414, 
                "isOSS": null, 
                "pointCount": 1, 
                "identifier": "aea05c6b808f0501d3aca7dca6ea77c7", 
                "userFileId": 7, 
                "userId": 1, 
                "fileName": "222333", 
                "filePath": "/测试1/", 
                "extendName": "jpg", 
                "isDir": 0, 
                "uploadTime": "2022-02-28 11:55:19"
            }
        ]
    }
}
```

</details>

## 文件传输接口

### 下载文件

- 接口描述：下载文件接口
- 数据格式：JSON
- 请求方式：GET
- 接口 URL ：`http://localhost:8080/filetransfer/downloadfile?userFileId=2`

请求数据说明：

| 参数名称   | 参数说明    | 请求类型 | 是否必须 | 数据类型 |
| ---------- | ----------- | -------- | -------- | -------- |
| userFileId | 用户文件 id | query    | true     | int      |

响应数据说明：

无

### 获取存储信息

- 接口描述：获取存储信息
- 数据格式：JSON
- 请求方式：GET
- 接口 URL ：`http://localhost:8080/filetransfer/getstorage?token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOi`

请求数据说明：

无

响应数据说明：

| 参数名称 | 参数说明                   | 类型    |
| -------- | -------------------------- | ------- |
| code     | 返回码                     | int     |
| data     | 响应数据                   | int     |
| message  | 处理结果信息               | String  |
| success  | 是否成功标识（true/false） | boolean |

<details>
  <summary>响应示例</summary>

```json
{
	"code": 20000,
	"data": 591419,
	"message": "成功",
	"success": true
}
```

</details>

### 极速上传

- 接口描述：校验文件 MD5 判断文件是否存在，如果存在直接上传成功并返回 skipUpload=true，如果不存在返回 skipUpload=false 需要再次调用该接口的 POST 方法
- 数据格式：JSON
- 请求方式：GET
- 接口 URL ：`http://localhost:8080/filetransfer/uploadfile?chunkNumber=1&chunkSize=1048576&currentChunkSize=1048576&totalSize=15152866&identifier=254bddb058fe39f6a5bebc6ffb5591e9&filename=Redis-x64-5.0.9.zip&relativePath=Redis-x64-5.0.9.zip&totalChunks=14&filePath=%2F&isDir=0`

请求数据说明：

| 参数名称         | 参数说明     | 是否必须 | 数据类型 |
| ---------------- | ------------ | -------- | -------- |
| chunkNumber      | 分片数       | true     | int      |
| chunkSize        | 分片大小     | true     | int      |
| currentChunkSize | 当前分片大小 | true     | int      |
| extendName       | 扩展名       | true     | String   |
| filePath         | 文件路径     | true     | String   |
| fileSize         | 文件大小     | true     | int      |
| filename         | 文件名       | true     | String   |
| identifier       | md5          | true     | String   |
| totalChunks      | 总分片数     | true     | int      |
| totalSize        | 总大小       | true     | int      |
| uploadTime       | 上传时间     | true     | String   |

响应数据说明：

| 参数名称                  | 参数说明                   | 类型         |
| ------------------------- | -------------------------- | ------------ |
| code                      | 返回码                     | int          |
| data                      | 响应数据                   | UploadFileVo |
| needMerge     | 是否需要合并分片           | boolean      |
| skipUpload    | 跳过上传                   | boolean      |
| timeStampName | 时间戳                     | String       |
| uploaded      | 已经上传的分片             | array        |
| message                   | 处理结果信息               | String       |
| success                   | 是否成功标识（true/false） | boolean      |

<details>
  <summary>响应示例</summary>

```json
{
	"code": 0,
	"data": {
		"needMerge": true,
		"skipUpload": true,
		"timeStampName": "123123123123",
		"uploaded": "[1,2,3]"
	},
	"message": "",
	"success": true
}
```

</details>

### 上传文件

- 接口描述：真正的上传文件接口
- 数据格式：JSON
- 请求方式：POST
- 接口 URL ：`http://localhost:8080/filetransfer/uploadfile`

请求数据说明：

| 参数名称         | 参数说明     | 是否必须 | 数据类型 |
| ---------------- | ------------ | -------- | -------- |
| chunkNumber      | 分片数量     | true     | int      |
| chunkSize        | 分片大小     | true     | int      |
| currentChunkSize | 当前分片大小 | true     | int      |
| extendName       | 扩展名       | true     | String   |
| filePath         | 文件路径     | true     | String   |
| fileSize         | 文件大小     | true     | int      |
| filename         | 文件名       | true     | String   |
| identifier       | md5 码       | true     | String   |
| totalChunks      | 总分片数     | true     | int      |
| totalSize        | 总大小       | true     | int      |
| uploadTime       | 上传时间     | true     | String   |

响应数据说明：

| 参数名称                  | 参数说明                   | 类型         | schema       |
| ------------------------- | -------------------------- | ------------ | ------------ |
| code                      | 返回码                     | int          | int          |
| data                      | 响应数据                   | UploadFileVo | UploadFileVo |
| needMerge     | 是否需要合并分片           | boolean      |              |
| skipUpload    | 跳过上传                   | boolean      |              |
| timeStampName | 时间戳                     | String       |              |
| uploaded      | 已经上传的分片             | array        | integer      |
| message                   | 处理结果信息               | String       |              |
| success                   | 是否成功标识（true/false） | boolean      |              |

<details>
  <summary>响应示例</summary>

```json
{
    "success": true, 
    "code": 20000, 
    "message": "成功", 
    "data": {
        "timeStampName": null, 
        "skipUpload": false, 
        "needMerge": false, 
        "uploaded": null
    }
}
```

</details>

## 用户接口

### 检查用户登录信息

- 接口描述：验证 token 的有效性
- 数据格式：JSON
- 请求方式：GET
- 接口 URL ：`http://localhost:8080/user/checkuserlogininfo`

请求数据说明：

无

响应数据说明：

| 参数名称             | 参数说明                   | 类型    |
| -------------------- | -------------------------- | ------- |
| code                 | 返回码                     | int     |
| data                 | 响应数据                   | User    |
| userId   | 用户 id                    | int     |
| username | 用户名                     | String  |
| message              | 处理结果信息               | String  |
| success              | 是否成功标识（true/false） | boolean |

<details>
  <summary>响应示例</summary>

```json
{
    "success": true, 
    "code": 20000, 
    "message": "成功", 
    "data": {
        "userId": 1, 
        "username": "test", 
        "telephone": "test123", 
        "registerTime": "2022-02-28 11:22:20"
    }
}
```

</details>

### 用户登录

- 接口描述：用户登录认证后才能进入系统
- 数据格式：JSON
- 请求方式：GET
- 接口 URL ：`http://localhost:8080/user/login`

请求数据说明：

| 参数名称  | 参数说明 | 是否必须 | 数据类型 |
| --------- | -------- | -------- | -------- |
| telephone | 手机号   | true     | String   |
| password  | 密码     | true     | String   |

响应数据说明：

| 参数名称             | 参数说明                   | 类型    |
| -------------------- | -------------------------- | ------- |
| code                 | 返回码                     | int     |
| data                 | 响应数据                   | LoginVO |
| token    | token                      | String  |
| username | 用户名                     | String  |
| message              | 处理结果信息               | String  |
| success              | 是否成功标识（true/false） | boolean |

<details>
  <summary>响应示例</summary>

```json
{
	"code": 0,
	"data": {
        "userId": 1, 
		"token": "eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ7XCJ1c2VySWRcIjoxLFwidXNlcm5hbWVcIjpcInRlc3RcIixcInBhc3N3b3JkXCI6XCJcIixcInRlbGVwaG9uZVwiOlwidGVzdDEyM1wiLFwic2FsdFwiOlwiXCIsXCJyZWdpc3Rl",
		"username": "test123"
	},
	"message": "",
	"success": true
}
```

</details>

### 用户注册

- 接口描述：注册账号
- 数据格式：JSON
- 请求方式：POST
- 接口 URL ：`http://localhost:8080/user/register`

<details>
  <summary>响应示例</summary>

```json
{
  "password": "test123",
  "telephone": "11122223333",
  "username": "test"
}
```

</details>

请求数据说明：

| 参数名称              | 参数说明 | 是否必须 | 数据类型 |
| --------------------- | -------- | -------- | -------- |
| password  | 密码     | true     | String   |
| telephone | 手机号   | true     | String   |
| username  | 用户名   | true     | String   |

响应数据说明：

| 参数名称 | 参数说明                   | 类型    |
| -------- | -------------------------- | ------- |
| code     | 返回码                     | int     |
| data     | 响应数据                   | String  |
| message  | 处理结果信息               | String  |
| success  | 是否成功标识（true/false） | boolean |

<details>
  <summary>响应示例</summary>

```json
{
	"code": 20000,
	"data": "",
	"message": "注册成功",
	"success": true
}
```

</details>

